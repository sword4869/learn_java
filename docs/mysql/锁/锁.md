

## 全局锁

全局锁就是对整个数据库实例加锁，加锁后整个实例就处于只读状态。

用于全库逻辑备份：
- 主库上备份：不能更新，业务停摆
- 从库上备份：主从延迟。
- 可以加上`--single-transaction`参数实现不加锁的一致性备份。



普通的 select 语句是利用 MVCC 实现一致性读，是无锁的（不会加行级锁）。

当执行插入、更新、删除操作，需要先对表加上「意向独占锁」，然后对该记录加独占锁。 





元数据锁自动加。



## 什么是间隙锁

## 什么是意向锁

**意向锁，意味着表中已经有记录被加了独占锁，目的是为了让「独占表锁」快速添加**。

如果没有「意向锁」，那么加「独占表锁」时，就需要遍历表里所有记录，查看是否有记录存在独占锁，这样效率会很慢。

 那么有了「意向锁」，由于在对记录加独占锁前，先会加上表级别的「意向独占锁」，那么在加「独占表锁」时，无须遍历就知道有记录被加了独占锁。



PS：意向共享锁和意向独占锁是表级锁，不会和行级的共享锁和独占锁发生冲突，而且意向锁之间也不会发生冲突，只会和共享表锁（lock tables ... read）和独占表锁（lock tables ... write）发生冲突。 表锁和行锁是满足读读共享、读写互斥、写写互斥的。 

