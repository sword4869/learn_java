# spring
## 1. spring的aop是如何实现的
Spring的AOP（面向切面编程）是通过动态代理实现的。

在Spring中，AOP通过在运行时动态地将切面织入到目标对象的方法中，从而实现横切关注点的模块化。

Spring AOP的实现方式有两种：基于代理的经典AOP和基于字节码的AspectJ AOP。

-   代理的经典AOP：JDK动态代理：基于接口的代理，通过java.lang.reflect.Proxy类和InvocationHandler接口实现。Spring使用JDK动态代理来代理实现了接口的目标对象。CGLIB动态代理：基于继承的代理，通过CGLIB库生成目标对象的子类来实现代理。Spring使用CGLIB动态代理来代理没有实现接口的目标对象。
-   基于字节码的AspectJ AOP：AspectJ是一个独立的AOP框架，它提供了更强大和灵活的AOP功能。Spring可以集成AspectJ，使用AspectJ注解或XML配置来定义切面和切点，然后通过编译时或运行时的织入方式将切面织入到目标对象中。

在Spring中，通过配置文件或注解来定义切面和切点，然后使用AOP代理将切面织入到目标对象的方法中。

当目标对象的方法被调用时，AOP代理会在方法执行前、执行后或抛出异常时执行切面的相关逻辑，实现横切关注点的功能，如日志记录、事务管理等。

需要注意的是，Spring AOP是基于代理的AOP，只能代理方法调用，而不能拦截对象的内部方法调用。如果需要更细粒度的控制和更强大的AOP功能，可以考虑使用AspectJ。
## 2. 三级缓存怎么解决循环依赖

## 3. spring注解

![alt text](../../images/image-131.png)

## 4. AOP 优点

1. 模块化

    通过将公共行为（如日志记录、事务管理）提取为独立的切面，可以使代码更加模块化，避免在多个地方重复编写相同的代码，提高代码的可重用性、可维护性和可读性。

2. 解耦

    将业务逻辑与横切关注点分离，使得非功能性需求（如日志记录、事务管理、安全检查等）可以集中管理和维护，而不是分散在各个业务模块中。从而降低业务逻辑的耦合性，提高程序的可扩展性。

## 5. AOP技术实现

1. 静态代理：编译时增强
   
   通过 AOP 框架提供的命令进行编译，从而在编译阶段生成 AOP 代理类。
   
   静态代理包括编译时编织和类加载时编织两种方式。
2. 动态代理：运行时增强
   
   运行时在内存中“临时”生成 AOP 动态代理类，动态代理主要有两种实现方式：
   - JDK 动态代理：要求被代理的类必须实现`InvocationHandler`接口，通过反射来接收被代理的类，使用 JDK 的 java.lang.reflect.Proxy 类来创建代理对象。代理对象会在运行时实现代理接口，并覆盖其中的方法，在方法调用前后执行切面逻辑。
   - CGLIB 动态代理：如果目标类没有实现接口，Spring AOP 会选择使用 CGLIB 来动态代理目标类。CGLIB 则是一个代码生成的类库，CGLIB 通过继承的方式实现代理，使用字节码技术创建目标类的子类，在子类中重写目标方法并在方法调用前后插入切面逻辑。

## 6. Spring AOP实现原理

-   **代理机制**：
    -   **JDK 动态代理**和 **CGLIB 动态代理**
-   **关键概念**：
    -   **切面（Aspect）**：切面是一个包含了横切关注点声明的模块化单元，它可以有多个切入点和通知组成。
    -   **切入点（Pointcut）**：切入点定义了匹配通知应该被织入的方法或方法执行点的规则表达式。
    -   **通知（Advice）**：通知是在特定切入点处执行的代码片段，分为多种类型，如前置通知（Before advice）、后置通知（After returning advice）、异常后通知（After throwing advice）、最终通知（After (finally) advice）以及环绕通知（Around advice）。
-   **织入（Weaving）**：织入是指将切面应用到目标对象来创建一个新的代理对象的过程。在 Spring AOP 中使用动态代理，织入发生在运行时。
-   **代理工厂**：Spring 内部通过 ProxyFactory、Advisor、AdvisorChainFactory 等来创建和管理代理对象。
-   **执行流程**：当客户端通过代理对象调用目标方法时，代理对象会拦截这个调用，根据切面配置找到对应的通知，根据通知类型执行不同的增强逻辑。
  
## 7. Spring 动态代理失效的场景有哪些？

## 8. 怎么证明Spring Boot 动态代理默认实现是 JDK 动态代理还是 CGLIB？